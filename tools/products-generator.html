<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Products.json Generator</title>
<style>
body {
  font-family: Arial;
  padding: 20px;
  background: #f2f2f2;
}
.box {
  background: white;
  padding: 20px;
  border-radius: 10px;
  max-width: 600px;
  margin: auto;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
input, button {
  margin-top: 15px;
}
button {
  padding: 10px 20px;
  font-size: 16px;
  cursor:pointer;
}
</style>
</head>
<body>

<div class="box">
  <h2>Excel → products.json Dönüştürücü</h2>
  <p><b>Excel formatı şöyle olmalı:</b></p>

  <table border="1" cellpadding="5" style="margin-bottom:10px;">
    <tr><th>kategori</th><th>link</th></tr>
    <tr><td>Kulaklık</td><td>https://www.sescibaba.com/xxx</td></tr>
  </table>

  <input type="file" id="excelFile" accept=".xlsx,.xls" />

  <button onclick="convertExcel()">Dönüştür ve JSON İndir</button>

  <p id="status" style="margin-top:15px; font-weight:bold;"></p>
</div>

<!-- SheetJS -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<script>
async function convertExcel() {
  const file = document.getElementById("excelFile").files[0];
  if (!file) {
    alert("Excel dosyası seçmedin.");
    return;
  }

  document.getElementById("status").innerText = "Dönüştürülüyor...";

  const data = await file.arrayBuffer();
  const workbook = XLSX.read(data);

  const sheet = workbook.Sheets[workbook.SheetNames[0]];
  const rows = XLSX.utils.sheet_to_json(sheet);

  // Boş JSON yapısı (111 kategori)
  let output = {
    "Stüdyo Paket Sistemler": [],
    "Ses Kartları": [],
    "Mikrofon": [],
    "Kulaklık": [],
    "Referans Monitörleri": [],
    "Klavyeler & Midi Klavyeler": [],
    "Synthesizer": [],
    "Mikser": [],
    "Midi & Daw Kontrol Üniteleri": [],
    "Prodüksiyon Yazılımları ve Plug-in": [],
    "Ses Yalıtım Malzemeleri": [],
    "Stüdyo Efekt Cihazları": [],
    "Ekolayzer": [],
    "Mobil Kayıt Üniteleri": [],
    "Elektro Davul": [],
    "Stand & Kablo": [],
    "Hoparlörler": [],
    "Ses Mikserleri": [],
    "Amfi": [],
    "Preamplifikatör": [],
    "Sahne Ses Sistemleri": [],
    "Konferans Ses Sistemleri": [],
    "Anons & Yayın Sistemleri": [],
    "Megafon": [],
    "Line Array Hoparlör": [],
    "Column Hoparlör - Setler": [],
    "Portatif PA Hoparlör": [],
    "Prosesör": [],
    "Enstrüman Amplifikatör": [],
    "Aksesuar - Yedek Parça": [],
    "Mobil Uyumlu Mikrofonlar": [],
    "Dinamik Mikrofon": [],
    "Condenser Mikrofon": [],
    "Vokal Mikrofonları": [],
    "Telsiz Mikrofonlar": [],
    "Konferans & Acil Anons Mikrofonları": [],
    "Stüdyo Mikrofonları": [],
    "Boundary Mikrofon": [],
    "Ribon Mikrofon": [],
    "USB Mikrofon": [],
    "Kamera Mikrofonu": [],
    "Yayıncı Mikrofonları": [],
    "Mikrofon Preamplifikatör": [],
    "Enstrüman Mikrofonları": [],
    "Ölçüm Mikrofonları": [],
    "Mikrofon Setleri": [],
    "Stand & Aksesuar": [],
    "True Wireless Kulaklık": [],
    "Noise Canceling Kulaklık": [],
    "Stüdyo Tipi Kulaklık": [],
    "DJ Tipi Kulaklık": [],
    "Kulak içi Kulaklık": [],
    "HiFi Kulaklık": [],
    "Kablosuz & Bluetooth Kulaklık": [],
    "Oyuncu Kulaklığı": [],
    "Sporcu Tipi Kulaklık": [],
    "In-Ear Monitör": [],
    "Mikrofonlu Kulaklık": [],
    "Kulaklık Preamfi": [],
    "Çocuk Kulaklıkları": [],
    "Aksesuar": [],
    "DJ Setup": [],
    "DJ Kontrol Üniteleri": [],
    "DJ Hoparlörleri ve Referans Monitörleri": [],
    "Player": [],
    "DJ Kulaklık": [],
    "DJ Mikser": [],
    "CD Player": [],
    "Turntable": [],
    "DJ Ses Kartları": [],
    "DJ Yazılımları": [],
    "DJ Aksesuarları": [],
    "Ses Sistemleri": [],
    "Stereo Amplifikatör": [],
    "Receiver & Ana Üniteler": [],
    "Hi-Fi Sistemler": [],
    "Pikap": [],
    "Bluetooth & Wireless Ses Sistemleri": [],
    "Görüntü": [],
    "Aksesuar (Home Audio)": [],
    "Projeksiyon": [],
    "Canlı Yayın Kameraları": [],
    "Modüler Videowall Ekranlar": [],
    "Switcher & Streamer": [],
    "LED Ekran": [],
    "Encoder Kartlar": [],
    "Motorlu - Sabit Perdeler": [],
    "Ses": [],
    "Işık": [],
    "Yayın Mikserleri": [],
    "Görüntü (Broadcast)": [],
    "Stant ve Aksesuarlar": [],
    "Standlar": [],
    "Kablolar": [],
    "Konnektörler": [],
    "Bilgisayar Aksesuarları": [],
    "Case": [],
    "Fan ve Termal Kontrol": [],
    "Dijital Multicore Sistemler": [],
    "Stage Box": [],
    "Güç Üniteleri": [],
    "Mağaza Paketleri": [],
    "Düğün Sistemleri": [],
    "Mobil Eğlence Sistemleri": [],
    "Club - Bar Sistemleri": [],
    "Restaurant Paketleri": [],
    "Sinema Sistemleri": [],
    "Merkezi Müzik Yayın ve Acil Anons": [],
    "Cami Sistemleri": [],
    "Okul Sistemleri": []
  };

  // Excel verilerini doldurma
  rows.forEach(row => {
    const cat = row.kategori?.trim();
    const link = row.link?.trim();

    if (output[cat] && link) {
      output[cat].push(link);
    }
  });

  // JSON indirme
  const blob = new Blob([JSON.stringify(output, null, 2)], {
    type: "application/json",
  });
  const urlBlob = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = urlBlob;
  a.download = "products.json";
  a.click();

  document.getElementById("status").innerText = "Tamamlandı → products.json indirildi!";
}
</script>

</body>
</html>
