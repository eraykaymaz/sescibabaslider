<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Excel → 111in1 Slider Generator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body { font-family: Arial; padding:20px; background:#fafafa; }
h1 { font-size:22px; margin-bottom:10px; }
table { border-collapse: collapse; width:100%; background:white; margin-top:20px; }
table th, table td { border:1px solid #ddd; padding:8px; font-size:14px; }
input[type=text] { width:100%; padding:6px; font-size:14px; }
button {
    background:#007bff; color:white; padding:10px 18px;
    border:none; border-radius:6px; cursor:pointer;
    margin-top:10px; font-size:15px;
}
button:hover { background:#005fcc; }
</style>
</head>
<body>

<h1>Excel → Slider Üretici</h1>

<input type="file" id="excelFile" accept=".xlsx,.xls" />
<button onclick="loadExcel()">Yükle</button>

<table id="dataTable" style="display:none;">
    <thead>
        <tr>
            <th>Kategori</th>
            <th>Ürün Linki</th>
            <th>Sil</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<button id="addRowBtn" style="display:none;" onclick="addRow()">Yeni Satır Ekle</button>

<button id="generateBtn" style="display:none;" onclick="generateHTML()">111in1 HTML Oluştur</button>

<script>
let tableBody = document.querySelector("#dataTable tbody");

// Excel Yükleme
function loadExcel() {
    let file = document.getElementById("excelFile").files[0];
    if (!file) return alert("Excel dosyası seç!");

    let reader = new FileReader();
    reader.onload = function (e) {
        let data = e.target.result;
        let workbook = XLSX.read(data, { type: "binary" });
        let sheet = workbook.Sheets[workbook.SheetNames[0]];
        let rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        tableBody.innerHTML = "";

        rows.forEach(row => {
            if (row.length >= 2) addRow(row[0], row[1]);
        });

        document.getElementById("dataTable").style.display = "table";
        document.getElementById("addRowBtn").style.display = "inline-block";
        document.getElementById("generateBtn").style.display = "inline-block";
    };
    reader.readAsBinaryString(file);
}

// Tabloya satır ekle
function addRow(cat="", link="") {
    let tr = document.createElement("tr");

    tr.innerHTML = `
        <td><input type="text" value="${cat}"></td>
        <td><input type="text" value="${link}"></td>
        <td><button onclick="this.parentElement.parentElement.remove()">X</button></td>
    `;

    tableBody.appendChild(tr);
}

// HTML üret ve indir
function generateHTML() {
    let rows = document.querySelectorAll("#dataTable tbody tr");

    let categories = {};

    rows.forEach(r => {
        let cat = r.children[0].children[0].value.trim();
        let link = r.children[1].children[0].value.trim();

        if (!cat || !link) return;

        if (!categories[cat]) categories[cat] = [];
        categories[cat].push(link);
    });

    let html = `
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
body{margin:0;font-family:Arial;}
.cat-block{display:none;padding:10px;}
.slider{display:flex;overflow-x:auto;gap:10px;padding:10px;}
.item{min-width:150px;border:1px solid #ccc;padding:10px;border-radius:6px;background:white;}
.title{font-weight:bold;margin-top:5px;font-size:14px;}
</style>

<script>
function getCat(){
    const p=new URLSearchParams(window.location.search);
    return p.get("cat");
}
window.onload=function(){
    let c=getCat();
    if(c) document.getElementById(c).style.display="block";
};
</script>
</head>
<body>
`;

    for (let cat in categories) {
        html += `<div class="cat-block" id="${cat}"><div class="slider">`;

        categories[cat].forEach(link => {
            html += `
                <div class="item">
                    <a href="${link}" target="_blank">
                        <div class="title">Ürün Başlığı</div>
                        <div class="price">Fiyat</div>
                    </a>
                </div>`;
        });

        html += `</div></div>`;
    }

    html += `</body></html>`;

    // DOSYA İNDİRME
    const blob = new Blob([html], {type: "text/html"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "111in1slider.html";
    a.click();
}
</script>

</body>
</html>

